<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title id="pageTitle">Menu</title>
  <style>
    :root{
      --bg: #0b0c0f; --card: #151821; --muted: #a7b0c0; --text: #e6eaf2;
      --brand: #ffb703; --brand-2: #ff7a59; --ring: 0 0 0 3px rgba(255,183,3,.25);
      --shadow: 0 10px 30px rgba(0,0,0,.25); --success: #10b981; --warning: #f59e0b; --error: #ef4444;
    }
    /* 라이트 모드 자동 활성화 비활성화 - 항상 다크 모드 기본값 */
    /* @media (prefers-color-scheme: light){
      :root{
        --bg: #f4f6fb; --card: #ffffff; --muted: #5a6577; --text: #0b0c0f;
        --brand: #e18f00; --brand-2: #e85d3f; --ring: 0 0 0 3px rgba(225,143,0,.20);
        --shadow: 0 10px 25px rgba(0,0,0,.08);
      }
    } */
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
      background: radial-gradient(1200px 800px at 80% -10%, rgba(255,183,3,.10), transparent 60%), var(--bg);
      color:var(--text);
    }
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:sticky; top:0; z-index:10; backdrop-filter:saturate(180%) blur(8px);}
    .header-inner{display:flex;gap:16px;align-items:center; justify-content:space-between; padding:16px 24px}
    .brand{display:flex;align-items:center; gap:12px}
    .logo{width:clamp(60px, 8vw, 120px);height:clamp(60px, 8vw, 120px);border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2)); background-image:url('images/Banner.png'); background-size:cover; background-position:center;}
    .title{font-size: clamp(20px, 3vw, 48px); font-weight:800;}
    .actions{display:flex; gap:8px; align-items:center}
    .search{padding:8px 12px; border:1px solid rgba(255,255,255,.1); border-radius:8px; background:var(--card); color:var(--text);}
    .lang-toggle{background:var(--brand); color:var(--bg); border:none; padding:8px 16px; border-radius:20px; cursor:pointer; font-weight:600; transition:all .2s}
    .lang-toggle:hover{background:var(--brand-2); transform:translateY(-1px)}
    .btn{
      border:1px solid transparent; background:var(--card); color:var(--text); padding:10px 14px; border-radius:12px;
      display:inline-flex; align-items:center; gap:8px; cursor:pointer; box-shadow: var(--shadow);
    }
    .btn:hover{border-color: rgba(255,255,255,.2)}
    .btn:focus-visible{outline:none; box-shadow: var(--ring)}
    .toggle{display:inline-flex; align-items:center; gap:8px}
    .light{--bg:#f4f6fb; --card:#fff; --muted:#5a6577; --text:#0b0c0f; --brand:#e18f00; --brand-2:#e85d3f; --ring:0 0 0 3px rgba(225,143,0,.20); --shadow:0 10px 25px rgba(0,0,0,.08)}
    /* ✅ 라이트 모드에서 메뉴 글씨/탭 글씨 명확히 보이도록 추가 */
    .light .tab{
      background: var(--card);
      color: #222;
      border: 1px solid rgba(0,0,0,.1);
    }

    .light .tab.active{
      background: var(--brand);
      color: #fff;
      border-color: var(--brand);
    }

    .light .menu-item{
      background: var(--card);
      border: 1px solid rgba(0,0,0,.08);
      color: var(--text);
    }

    .light .menu-item .item-name,
    .light .menu-item .item-desc,
    .light .menu-item .item-price {
      color: var(--text);
    }
    .filter-tabs{display:flex; gap:8px; margin:16px 0; flex-wrap:wrap}
    .tab{padding:8px 16px; border:1px solid rgba(255,255,255,.1); border-radius:20px; background:var(--card); color:white; cursor:pointer; transition:all .2s}
    .tab.active{background:var(--brand); color:var(--bg)}
    .menu-grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:20px; margin-top:24px}
    .menu-item{
      background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0) 30%), var(--card);
      border:1px solid rgba(255,255,255,.08); border-radius:18px; box-shadow: var(--shadow); overflow:hidden; display:flex; flex-direction:column; transition:transform .2s
    }
    .menu-item:hover{transform:translateY(-2px)}
    .item-image{height:260px; background:#0e1118 center/cover no-repeat; cursor:pointer; transition:transform .2s; position:relative}
    .item-image:hover{transform:scale(1.03)}
    .multi-indicator{
      position:absolute; right:12px; bottom:12px; background:rgba(0,0,0,.45); color:white; padding:6px 10px; border-radius:999px; font-size:12px;
      backdrop-filter: blur(4px);
    }
    
    /* 이미지 모달 스타일 */
    .image-modal{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.9); z-index:1000; display:none; align-items:center; justify-content:center; cursor:pointer}
    .modal-image{max-width:90%; max-height:80%; border-radius:8px; box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .modal-close{position:absolute; top:20px; right:30px; color:white; font-size:40px; font-weight:bold; cursor:pointer; transition:color .2s}
    .modal-close:hover{color:var(--brand)}
    .modal-info{position:absolute; bottom:30px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,.8); color:white; padding:12px 20px; border-radius:8px; text-align:center; max-width:90%}
    .modal-title{font-size:18px; font-weight:600; margin-bottom:4px}
    .modal-description{font-size:14px; opacity:.8}
    .modal-counter{font-size:13px; opacity:0.9; margin-top:6px}
    .modal-prev, .modal-next {
      position: absolute;
      top: 50%;
      font-size: 48px;
      color: white;
      cursor: pointer;
      padding: 8px 16px;
      user-select: none;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.25);
      border-radius: 8px;
    }
    .modal-prev { left: 28px; }
    .modal-next { right: 28px; }
    .modal-prev:hover, .modal-next:hover { color: var(--brand); background: rgba(255,255,255,0.04); }

    .item-content{padding:16px}
    .item-name{font-size:16px; font-weight:600; margin-bottom:8px}
    .item-description{color:var(--muted); font-size:14px; margin-bottom:12px; line-height:1.4}
    .item-footer{display:flex; justify-content:space-between; align-items:center}
    .item-price{font-weight:700; color:var(--brand); font-size:16px}
    .item-category{display:inline-block; font-size:12px; padding:6px 12px; background:rgba(255,183,3,.12); color:#ffde8a; border:1px solid rgba(255,183,3,.2); border-radius:999px; text-align:center}
    .stats{display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin:24px 0}
    .stat-card{background:var(--card); padding:16px; border-radius:8px; text-align:center}
    .stat-number{font-size:24px; font-weight:700; color:var(--brand)}
    .stat-label{color:var(--muted); font-size:14px; margin-top:4px}
    .update-info{background:var(--success); color:white; padding:12px; border-radius:8px; margin:16px 0; text-align:center}
    .loading{text-align:center; padding:40px; color:var(--muted)}
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-inner">
        <div class="brand">
          <div class="logo"></div>
          <h1 class="title" id="mainTitle">바샤커피 메뉴판</h1>
        </div>
        <div class="actions">
          <input type="text" class="search" placeholder="메뉴 검색..." id="searchInput">
          <button id="forceRefresh" class="btn" data-tip="강력 새로고침 (캐시 삭제)"><span>🔄</span><span>새로고침</span></button>
          <button id="toggleTheme" class="btn toggle" data-tip="라이트/다크 전환"><span>🌓</span><span>테마</span></button>
          <button class="lang-toggle" id="langToggle" onclick="toggleLanguage()">English</button>
        </div>
      </div>
    </header>

    <main>
      <div class="filter-tabs" id="filterTabs">
        <button class="tab active" data-category="all" id="allTab">전체</button>
      </div>

      <div class="menu-grid" id="menuGrid">
        <div class="loading">메뉴를 불러오는 중...</div>
      </div>
    </main>
  </div>
  <!-- 이미지 모달 -->
  <div class="image-modal" id="imageModal" aria-hidden="true">
    <div class="modal-close" onclick="closeImageModal()">&times;</div>
    <div class="modal-prev" onclick="prevImage()" role="button" aria-label="Previous image">&#10094;</div>
    <img class="modal-image" id="modalImage" src="" alt="">
    <div class="modal-next" onclick="nextImage()" role="button" aria-label="Next image">&#10095;</div>
    <div class="modal-info" id="modalInfo">
      <div class="modal-title" id="modalTitle"></div>
      <div class="modal-description" id="modalDescription"></div>
      <div class="modal-counter" id="modalCounter"></div>
    </div>
  </div>

  <script>
    let currentLanguage = 'ko';
    let menuDataKo = [];
    let menuDataEn = [];
    let currentCategory = 'all';

    // 메뉴 데이터 (한국어) - 이미지 칸에 여러 파일을 쉼표(,)로 구분해서 넣을 수 있습니다.
    const menuTextKo = `# 바샤커피 메뉴 관리 파일
# 형식: 카테고리|이름|설명|가격|이미지파일명(콤마로 구분 가능)|태그(옵션)
# 주석은 #으로 시작

# === 월간 메뉴 ===
월간 메뉴|월간 세트 메뉴|10월 한정|89000|Monthly Menu/먼슬리1.jpg,Monthly Menu/월간메뉴2.jpg,Monthly Menu/먼슬리3.jpg,Monthly Menu/먼슬리4.jpg|,10월,한정메뉴

# === 바리스타 추천 원두 ===
바리스타 추천 원두|마야 오로 커피|중앙 아메리카 마야 문명의 신비로운 금을 떠올리게 한다. NOTE : 녹색 아몬드 , 코코아,붉은 과일의 가벼운 풍미|16000|Barista's Pick/원두.jpg|밀라노 모닝, 바리스타,추천


# === 하우스 페스추리 ===
하우스 페스추리|라즈베리 바닐라 앙트르메|라즈베리 무스를 사용한 정통 앙트르메|12000|housemade-pastries/바샤청담_라즈베리바닐라앙트르메.jpg|라즈베리,바닐라,프렌치
하우스 페스추리|레몬 타르트|레몬 커드로 만든 상큼한 타르트|12000|housemade-pastries/바샤청담_레몬타르트.jpg|레몬,타르트
하우스 페스추리|밀푀유|Out of Africa 원두로 만든 마스카포네 크림이 들어간 밀푀유|12000|housemade-pastries/바샤청담_밀푀유.jpg|밀푀유,퍼프페이스트리
하우스 페스추리|블랙펄 커피 오페라|커피 시럽에 적신 스펀지와 블랙펄 버터 가나슈를 겹겹이 쌓은 케이크|12000|housemade-pastries/바샤청담_블랙펄커피오페라.jpg|커피,오페라케이크
하우스 페스추리|자허토르테|진한 초콜릿과 캔디드 오렌지 필의 조화|12000|housemade-pastries/바샤청담_자허토르테.jpg|초콜릿,자허토르테
# === 샌드위치 ===
샌드위치|바샤 클럽 샌드위치|비프 베이컨, 계란 프라이, 수비드 치킨을 넣은 샌드위치|25000|sandwich/바샤청담_바샤클럽샌드위치.jpg|클럽샌드위치,시그니처
샌드위치|치킨 프렌치 토스트 샌드위치|수비드 치킨, 할라피뇨, 체다 치즈가 어우러진 프렌치 토스트|28000|sandwich/바샤청담_치킨프렌치토스트샌드위치.jpg|치킨,프렌치토스트
샌드위치|한우 채끝 프렌치 토스트 샌드위치|한우 투플러스 채끝과 캐러멜라이즈드 어니언이 들어간 프렌치 토스트|35000|sandwich/바샤청담_한우채끝프렌치토스트샌드위치.jpg|한우,채끝,프렌치토스트,프리미엄

# === 아이스 디저트 ===
아이스 디저트|소르베 아이스크림|소르베 - 코코넛 / 딸기 , 아이스크림 - 바닐라 / 피스타치오/ 카모심|10000|ice-desserts/바샤청담_소르베아이스크림.jpg|소르베,아이스크림,코코넛,딸기
아이스 디저트|스트로베리 멜바|피스타치오 아이스크림, 레몬 쇼트브레드, 딸기 쿨리|12000|ice-desserts/스트로베리멜바.jpg|스트로베리 멜바
아이스 디저트|카페 리에주아|카모심 커피 아이스크림, 헤이즐넛 쇼트브레드, 캐러멜로 모닝 커피|12000|ice-desserts/카페리에주아.jpg|카페 리에주아

# === 신선한 계란 요리 ===
신선한 계란 요리|스크램블 에그와 블랙 트러플|블랙 트러플을 넣은 스크램블 에그와 브리오슈 스틱|28000|farm-fresh-eggs/바샤청담_스크램블에그와블랙트러플.jpg|스크램블에그,블랙트러플,트러플
신선한 계란 요리|에그 프라이와 홈메이드 비프 콩피|홈메이드 비프 콩피가 들어간 서니 사이드업|28000|farm-fresh-eggs/바샤청담_에그프라이와홈메이드비프콩피.jpg|달걀,비프콩피,프라이,콩피
신선한 계란 요리|프랑스식 오믈렛|콩테 치즈와 로메스코 소스를 곁들인 오믈렛|22000|farm-fresh-eggs/바샤청담_프랑스식오믈렛.jpg|오믈렛,프랑스식,콩테,치즈

# === 메인 요리 ===
메인 요리|모로칸 케프타 미트볼|정통 모로칸 스타일의 부드러운 케프타 미트볼|37000|main/바샤청담_모로칸케프타미트볼.jpg|모로칸,미트볼,향신료
메인 요리|자타르 크러스트 연어|자타르 향신료와 감자 퐁당, 밤 벨루테를 곁들인 연어|39000|main/바샤청담_자타르크러스트연어.jpg|연어,자타르
메인 요리|전복 리조또|완도산 전복과 만다린 파마산 소스를 넣은 전복 리조또|39000|main/바샤청담_전복리조또.jpg|전복,리조또,프리미엄
메인 요리|치킨 탈리아텔레|트러플 버섯과 치킨 콩피가 어우러진 크림소스 탈리아텔레 파스타|39000|main/바샤청담_치킨탈리아텔레.jpg|치킨,탈리아텔레,파스타
메인 요리|한우 안심|투플러스 한우 안심, 감자 퓌레, 라즈베리 & 비터 초콜릿 소스|45000|main/바샤청담_한우안심.jpg|한우,안심,스테이크,프리미엄

# === 크로아상과 케이크 ===
크로아상과 케이크|버터 크루아상|AOP 버터로 완성한 깊고 진한 풍미|9900|croissants-and-cakes/바샤청담_버터크루아상.jpg|크루아상,버터
크로아상과 케이크|라즈베리 시나몬 크루아상|라즈베리 시나몬 잼이 가득한 크루아상|9900|croissants-and-cakes/바샤청담_라즈베리시나몬크루아상.jpg|크루아상,라즈베리,시나몬
크로아상과 케이크|솔티드 캐러멜 크루아상|솔티드 캐러멜이 어루어진 크루아상|9900|croissants-and-cakes/솔티드 캐러멜.jpg|크루아상,캐러멜,솔티드
크로아상과 케이크|초코 크루아상|1910 커피와 초콜릿의 조화|9900|croissants-and-cakes/바샤청담_초코크루아상.jpg|크루아상,초콜릿
크로아상과 케이크|피스타치오 크루아상|깊은 피스타치오 맛을 느낄수 있는  크루아상|9900|croissants-and-cakes/바샤청담_피스타치오크루아상.jpg|크루아상,피스타치오
크로아상과 케이크|브리오쉬 페이테|터키쉬 딜라이트 커피와 헤이즐넛 가나슈로 채운 페이스트리|12000|croissants-and-cakes/바샤청담_브리오쉬페이테.jpg|브리오쉬,프랑스
크로아상과 케이크|카페 라틴 초콜릿 키비라 레인 커피|키바라 레인 커피와 초콜릿의 환상적인 조화|12000|croissants-and-cakes/바샤청담_카페라틴초콜렛키비라레인커피.jpg|커피,초콜릿,키비라
크로아상과 케이크|레몬 케이크|상큼한 레몬 향이 가득한 케이크|9900|croissants-and-cakes/바샤청담_레몬케이크.jpg|케이크,레몬
크로아상과 케이크|마블 케이크|100% 아라비카 커피 향이 가득한 케이크|9900|croissants-and-cakes/바샤청담_마블케이크.jpg|케이크,마블,커피
크로아상과 케이크|초콜릿 피스타치오 케이크|플뢰르 드 셀 초콜릿과 피스타치오의 고급스러운 조합|9900|croissants-and-cakes/바샤청담_초콜렛피스타치오케이크.jpg|케이크,초콜릿,피스타치오
크로아상과 케이크|크루아상 콩테 치즈|콩테 치즈 크루아상과 루꼴라 샐러드|17000|croissants-and-cakes/바샤청담_크루아상콩테치즈.jpg|크루아상,콩테치즈
크로아상과 케이크|크루아상 트러플 버섯|트러플 버섯 크루아상과 루꼴라 샐러드|17000|croissants-and-cakes/바샤청담_크루아상트러플버섯.jpg|크루아상,트러플,버섯,프리미엄


# === 샐러드 ===
샐러드|니스식 바샤 샐러드|라임 칠리 비네그레트와 눈다랑어가 어우러진 상큼한 샐러드|28000|salad/바샤청담_니스식바샤샐러드.jpg|샐러드,니스식,참치,프렌치
샐러드|마라케시 스파이스 치킨 샐러드|모로코 향신료와 비엔나 던 비네그레트를 곁들인 치킨 샐러드|28000|salad/바샤청담_마라케시스파이스치킨샐러드.jpg|샐러드,치킨,마라케시,스파이스

# === 바샤 시그니처 디저트 ===
바샤 시그니처 디저트|브래드와 버터 푸딩|프랑스식 커스타드와 크루아상으로 만든 브레드 푸딩|18000|signature-dessert/바샤청담_브래드와버터푸딩.jpg|브래드푸딩,커스타드,시그니처
바샤 시그니처 디저트|티라미수|아마레티와 커피 젤리가 들어간 마스카포네 티라미수|16000|signature-dessert/바샤청담_티라미수.jpg|티라미수,시그니처
바샤 시그니처 디저트|홈메이드 추로스|직접 만든 레몬 도우 추로스와 수제 초콜릿 소스|12000|signature-dessert/바샤청담_홈메이드추로스.jpg|추로스,홈메이드,시그니처`;
   
 // 메뉴 데이터 (영어) - 동일하게 이미지 칸에 여러 파일을 넣을 수 있습니다.
    const menuTextEn = `# Bacha Coffee Menu Management File (English)
# Format: Category|Name|Description|Price|ImageFile(s) (comma separated)|Tags(Optional)
# Comments start with #

# === Monthly Menu ===
Monthly Menu|Monthly Set|Oct Limited|89000|Monthly Menu/먼슬리1.jpg,Monthly Menu/월간메뉴2.jpg,Monthly Menu/먼슬리3.jpg,Monthly Menu/먼슬리4.jpg|Oct,Limited menu

# === Barista's Pick ===
 Barista's Pick|Maya Oro Coffee|The elusive gold of the Mayans is brought to mind by this glorious Central American coffee, which produces light overtones of green almonds, cracked cocoa beans and red fruits.|16000|Barista's Pick/원두.jpg|Maya Oro, Barista,suggestion


# === Housemade Pastries ===
Housemade Pastries|Raspberry Vanilla Entremets|Mascarpone cream, raspberry cream, vanila ganache|12000|housemade-pastries/바샤청담_라즈베리바닐라앙트르메.jpg|raspberry,vanilla,french
Housemade Pastries|Lemon Tart|Sweet and tangy tart with lemon curd|12000|housemade-pastries/바샤청담_레몬타르트.jpg|lemon,tart
Housemade Pastries|Mille-feuille|Layered pastry with mascarpone cream made from “Out of Africa” coffee|12000|housemade-pastries/바샤청담_밀푀유.jpg|mille-feuille,puff pastry
Housemade Pastries|Black Pearl Coffee Opera|Coffee-soaked sponge layered with black pearl butter ganache|12000|housemade-pastries/바샤청담_블랙펄커피오페라.jpg|coffee,opera cake
Housemade Pastries|Sachertorte|Rich chocolate ganache cake with candied orange|12000|housemade-pastries/바샤청담_자허토르테.jpg|chocolate,sachertorte


# === Sandwich ===
Sandwich|Bacha Club Sandwich|Beef bacon, fried egg and sous-vide chicken|25000|sandwich/바샤청담_바샤클럽샌드위치.jpg|club sandwich,signature
Sandwich|Chicken French Toast Sandwich|Sous-vide chicken, jalapeño and cheddar cheese|28000|sandwich/바샤청담_치킨프렌치토스트샌드위치.jpg|chicken,french toast
Sandwich|Korean Beef Sirloin French Toast Sandwich|Korean beef striploin and caramelized onion|35000|sandwich/바샤청담_한우채끝프렌치토스트샌드위치.jpg|korean beef,sirloin,french toast,premium

# === Ice Desserts ===
Ice Desserts|Sorbet Ice Cream|Ice Cream - Vanilla / Pistachio / Camocim , Sorbet - Coconut / Strawberry|10000|ice-desserts/바샤청담_소르베아이스크림.jpg|sorbet,ice cream
Ice Desserts|Melba|Pistachio ice cream, raspberry crisps, strawberry coulis|12000|ice-desserts/스트로베리멜바.jpg|sorbet,ice cream
Ice Desserts|Cafe Liègeois|Camocim coffee ice cream with caramel and hazelnut, caramelo morning|12000|ice-desserts/카페리에주아.jpg|sorbet,ice cream
# === Farm Fresh Eggs ===
Farm Fresh Eggs|Scrambled Eggs with Black Truffle|Black truffle scrambled egg with brioche sticks|32000|farm-fresh-eggs/바샤청담_스크램블에그와블랙트러플.jpg|scrambled eggs,black truffle,premium
Farm Fresh Eggs|Fried Eggs with Homemade Beef Confit|Sunny side up with homemade beef confit|28000|farm-fresh-eggs/바샤청담_에그프라이와홈메이드비프콩피.jpg|eggs,beef confit,premium
Farm Fresh Eggs|French-style Omelet|Comté cheese omelette with romesco sauce|18000|farm-fresh-eggs/바샤청담_프랑스식오믈렛.jpg|omelet,french style

# === Main ===
Main|Moroccan Kefta Meatballs|Moroccan-style meatballs with zucchini ragout and tomato sauce|37000|main/바샤청담_모로칸케프타미트볼.jpg|moroccan,meatballs,spices
Main|Za'atar Crusted Salmon|Grilled salmon, Potato fondant and chestnut velouté|39000|main/바샤청담_자타르크러스트연어.jpg|salmon,zaatar,crusted
Main|Abalone Risotto| Butter poached Korean abalone , mandarin parmesan sauce|39000|main/바샤청담_전복리조또.jpg|abalone,risotto,premium
Main|Chicken Tagliatelle|Tagliatelle with fresh truffle mushroom and chicken confit|39000|main/바샤청담_치킨탈리아텔레.jpg|chicken,tagliatelle,pasta
Main|Korean Beef Tenderloin|Korean beef tenderloin with potato purée, raspberry & bitter chocolate sauce|45000|main/바샤청담_한우안심.jpg|korean beef,tenderloin,steak,premium

# === Croissants and Cakes ===
Croissants and Cakes|Butter Croissant|Rich flavor made with AOP butter|9900|croissants-and-cakes/바샤청담_버터크루아상.jpg|croissant,butter
Croissants and Cakes|Raspberry Cinnamon Croissant|Filled with raspberry cinnamon jam|9900|croissants-and-cakes/바샤청담_라즈베리시나몬크루아상.jpg|croissant,raspberry,cinnamon
Croissants and Cakes|Salted Caramel Croissant| Croissant with salted caramel|9900|croissants-and-cakes/솔티드캐러멜.jpg|croissant,salted,caramel
Croissants and Cakes|Chocolate Croissant|Filled with 1910 coffee and chocolate|9900|croissants-and-cakes/바샤청담_초코크루아상.jpg|croissant,chocolate
Croissants and Cakes|Pistachio Croissant|Croissant with pistachio paste|9900|croissants-and-cakes/바샤청담_피스타치오크루아상.jpg|croissant,pistachio
Croissants and Cakes|Brioche Feuilletée|Filled with hazelnut ganache and Turkish delight coffee|12000|croissants-and-cakes/바샤청담_브리오쉬페이테.jpg|brioche,french
Croissants and Cakes|Café Latin Chocolate Kivila Rain Coffee| Perfect harmony of Kibira Rain coffee and chocolate|12000|croissants-and-cakes/바샤청담_카페라틴초콜렛키비라레인커피.jpg|coffee,chocolate,kivila
Croissants and Cakes|Lemon Cake|Refreshing cake with lemon aroma|9900|croissants-and-cakes/바샤청담_레몬케이크.jpg|cake,lemon
Croissants and Cakes|Marble Cake|Full of 100% Arabica coffee flavor|9900|croissants-and-cakes/바샤청담_마블케이크.jpg|cake,marble,coffee
Croissants and Cakes|Chocolate Pistachio Cake|Luxurious combination of Fleur de Sel chocolate and pistachio|9900|croissants-and-cakes/바샤청담_초콜렛피스타치오케이크.jpg|cake,chocolate,pistachio
Croissants and Cakes|Croissant with Comté Cheese|Comté cheese croissant with arugula salad|17000|croissants-and-cakes/바샤청담_크루아상콩테치즈.jpg|croissant,comte cheese
Croissants and Cakes|Croissant with Truffle Mushroom|Truffle mushroom croissant with arugula salad|17000|croissants-and-cakes/바샤청담_크루아상트러플버섯.jpg|croissant,truffle,mushroom,premium

# === Salad ===
Salad|Bacha Niçoise Salad|Bigeye tuna, Boiled eggs, sweet lime chili vinaigrette|28000|salad/바샤청담_니스식바샤샐러드.jpg|salad,nicoise,tuna,french
Salad|Marrakech Spice Chicken Salad|Moroccan spices, Garbanzo beans, Vienna Dawn vinaigrette|28000|salad/바샤청담_마라케시스파이스치킨샐러드.jpg|salad,chicken,marrakech,spices

# === Our Signature Dessert ===
Our Signature Dessert|Bread and Butter Pudding|Classic French-style custard bread pudding|18000|signature-dessert/바샤청담_브래드와버터푸딩.jpg|bread pudding,butter,signature
Our Signature Dessert|Tiramisu|Mascarpone tiramisu with amaretti and coffee jelly|16000|signature-dessert/바샤청담_티라미수.jpg|tiramisu,signature
Our Signature Dessert|Homemade Churros|Lemon dough, served with chocolate sauce|12000|signature-dessert/바샤청담_홈메이드추로스.jpg|churros,homemade,signature`;
    // 언어별 UI 텍스트
    const uiText = {
      ko: {
        title: 'Menu',
        langButton: 'English',
        searchPlaceholder: '메뉴 검색...',
        updateInfo: '✅ 정리된 이미지와 새로운 메뉴로 업데이트된 최신 메뉴입니다',
        totalLabel: '총 메뉴',
        categoryLabel: '카테고리',
        minLabel: '최저가',
        maxLabel: '최고가',
        allTab: '전체',
        loading: '메뉴를 불러오는 중...'
      },
      en: {
        title: 'Menu',
        langButton: '한국어',
        searchPlaceholder: 'Search menu...',
        updateInfo: '✅ Latest menu updated with organized images and new dishes',
        totalLabel: 'Total Items',
        categoryLabel: 'Categories',
        minLabel: 'Min Price',
        maxLabel: 'Max Price',
        allTab: 'All',
        loading: 'Loading menu...'
      }
    };

    // 파서: 이미지 칸에서 여러 파일명을 처리하도록 수정 (쉼표로 구분)
    function parseMenu(menuText) {
      const lines = menuText.split('\n').filter(line =>
        line.trim() && !line.trim().startsWith('#')
      );

      return lines.map(line => {
        const [category, name, description, price, imageField = '', tags] = line.split('|');
        const images = (imageField || '').split(',').map(s => s.trim()).filter(Boolean);
        return {
          category: category?.trim(),
          name: name?.trim(),
          description: description?.trim(),
          price: parseInt(price?.trim()) || 0,
          images: images.length ? images : ['placeholder.jpg'], // 이미지 없으면 placeholder
          tags: tags?.trim()?.split(',').map(t => t.trim()) || []
        };
      }).filter(item => item.category && item.name);
    }

    function updateUI() {
      const ui = uiText[currentLanguage];
      const currentData = currentLanguage === 'ko' ? menuDataKo : menuDataEn;

      // 제목 및 버튼 업데이트
      document.getElementById('pageTitle').textContent = ui.title;
      document.getElementById('mainTitle').textContent = ui.title;
      document.getElementById('langToggle').textContent = ui.langButton;
      document.getElementById('searchInput').placeholder = ui.searchPlaceholder;

      // 탭 업데이트
      updateTabs();

      // 메뉴 표시
      displayMenu();
    }

    function updateTabs() {
      const ui = uiText[currentLanguage];
      const currentData = currentLanguage === 'ko' ? menuDataKo : menuDataEn;
      const categories = [...new Set(currentData.map(item => item.category))];

      const filterTabs = document.getElementById('filterTabs');
      filterTabs.innerHTML = `<button class="tab active" data-category="all">${ui.allTab}</button>` +
        categories.map(cat => `<button class="tab" data-category="${cat}">${cat}</button>`).join('');

      // 탭 이벤트 재등록
      filterTabs.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          filterTabs.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          currentCategory = tab.dataset.category;
          filterMenu();
        });
      });
    }

    // 메뉴 그리드 렌더링: DOM 요소를 직접 생성하도록 변경 (안전하고 유연함)
    function displayMenu() {
      const currentData = currentLanguage === 'ko' ? menuDataKo : menuDataEn;
      const menuGrid = document.getElementById('menuGrid');

      if (!currentData || !currentData.length) {
        menuGrid.innerHTML = `<div class="loading">${uiText[currentLanguage].loading}</div>`;
        return;
      }

      menuGrid.innerHTML = ''; // 초기화

      currentData.forEach(item => {
        const wrapper = document.createElement('div');
        wrapper.className = 'menu-item';
        wrapper.dataset.category = item.category;
        wrapper.dataset.name = item.name.toLowerCase();
        wrapper.dataset.tags = (item.tags || []).join(' ').toLowerCase();

        // 대표 이미지(첫 번째)
        const imageDiv = document.createElement('div');
        imageDiv.className = 'item-image';
        
        // 이미지 경로 처리 - 특수문자 이스케이프
        const imagePath = `images/${item.images[0]}`;
        
        // 이미지 경로 설정 - 완전한 URL 인코딩 적용
        try {
          // 경로의 각 부분을 개별적으로 인코딩
          const pathParts = imagePath.split('/');
          const encodedPath = pathParts.map(part => encodeURIComponent(part)).join('/');
          
          // background-image 설정
          imageDiv.style.backgroundImage = `url("${encodedPath}")`;
          
          // 실제 이미지 로드 테스트
          const testImg = new Image();
          testImg.onload = function() {
            console.log(`✅ 이미지 로드 성공: ${imagePath}`);
          };
          testImg.onerror = function() {
            console.error(`❌ 이미지 로드 실패: ${imagePath}`);
            console.error(`인코딩된 경로: ${encodedPath}`);
            
            // fallback 처리
            imageDiv.style.backgroundColor = '#f8f9fa';
            imageDiv.style.backgroundImage = 'none';
            imageDiv.innerHTML = `<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#6c757d;font-size:14px;text-align:center;">
              <div>
                <div style="font-size:24px;">📷</div>
                <div style="font-size:12px;margin-top:4px;">이미지 로드 실패</div>
              </div>
            </div>`;
          };
          testImg.src = encodedPath;
          
          // 디버깅 정보
          if (imagePath.includes("Pick")) {
            console.log(`원본 경로: ${imagePath}`);
            console.log(`인코딩된 경로: ${encodedPath}`);
          }
        } catch (error) {
          console.error('이미지 설정 오류:', error, imagePath);
        }

        // 다중 이미지 표시 인디케이터 (2장 이상이면 표시)
        if (item.images.length > 1) {
          const ind = document.createElement('div');
          ind.className = 'multi-indicator';
          ind.textContent = `${item.images.length}장`;
          imageDiv.appendChild(ind);
        }

        // 클릭하면 이미지 배열을 전달 (경로 앞에 images/ 추가)
        imageDiv.addEventListener('click', (e) => {
          openImageModal(item.images.map(p => `images/${p}`), item.name, item.description);
        });
        imageDiv.setAttribute('role', 'img');
        imageDiv.setAttribute('aria-label', item.name);

        // 내용
        const content = document.createElement('div');
        content.className = 'item-content';
        content.innerHTML = `
          <div class="item-category">${item.category}</div>
          <h3 class="item-name">${item.name}</h3>
          <p class="item-description">${item.description}</p>
          <div class="item-footer">
            <span class="item-price">₩${item.price.toLocaleString()}</span>
          </div>
        `;

        wrapper.appendChild(imageDiv);
        wrapper.appendChild(content);
        menuGrid.appendChild(wrapper);
      });

      filterMenu();
    }

    function filterMenu() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const items = document.getElementById('menuGrid').querySelectorAll('.menu-item');

      items.forEach(item => {
        const matchesCategory = currentCategory === 'all' || item.dataset.category === currentCategory;
        const matchesSearch = searchTerm === '' ||
          item.dataset.name.includes(searchTerm) ||
          item.dataset.tags.includes(searchTerm);

        item.style.display = matchesCategory && matchesSearch ? 'block' : 'none';
      });
    }

    function toggleLanguage() {
      currentLanguage = currentLanguage === 'ko' ? 'en' : 'ko';
      currentCategory = 'all';
      updateUI();
    }

    // ===== 테마 토글 (test.html과 동일) =====
    const themeState = {
      theme: localStorage.getItem('theme') || 'auto' // 'auto' | 'light'
    };

    function applyTheme(){
      if(themeState.theme==='light') document.body.classList.add('light');
      else document.body.classList.remove('light');
    }

    function initTheme() {
      document.getElementById('toggleTheme').addEventListener('click',()=>{
        themeState.theme = themeState.theme==='light' ? 'auto' : 'light';
        localStorage.setItem('theme', themeState.theme);
        applyTheme();
      });
      applyTheme();
    }

    // 강력 새로고침 기능
    function forceRefresh() {
      // 버튼 애니메이션
      const btn = document.getElementById('forceRefresh');
      const icon = btn.querySelector('span');
      icon.style.animation = 'spin 1s linear';

      // 캐시 삭제 및 새로고침
      if ('caches' in window) {
        caches.keys().then(function(names) {
          for (let name of names) caches.delete(name);
        });
      }

      // 로컬스토리지에서 캐시 관련 데이터 삭제 (테마 설정은 유지)
      const theme = localStorage.getItem('theme');
      localStorage.clear();
      if (theme) localStorage.setItem('theme', theme);

      // 강력 새로고침 (캐시 무시)
      setTimeout(() => {
        window.location.reload(true);
      }, 500);
    }

    // 이미지 모달 관련 - 슬라이드 기능 추가
    let modalImages = [];
    let currentImageIndex = 0;

    function openImageModal(imagesArray, title, description) {
      if (!imagesArray || !imagesArray.length) return;
      modalImages = imagesArray;
      currentImageIndex = 0;
      updateModalImage();
      document.getElementById('modalTitle').textContent = title || '';
      document.getElementById('modalDescription').textContent = description || '';
      document.getElementById('modalCounter').textContent = `${currentImageIndex + 1} / ${modalImages.length}`;
      const modal = document.getElementById('imageModal');
      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
    }

    function updateModalImage() {
      const modalImage = document.getElementById('modalImage');
      // 모달에서도 완전한 URL 인코딩 적용
      const imagePath = modalImages[currentImageIndex];
      const pathParts = imagePath.split('/');
      const encodedPath = pathParts.map(part => encodeURIComponent(part)).join('/');
      
      modalImage.src = encodedPath;
      modalImage.alt = document.getElementById('modalTitle').textContent || '';
      document.getElementById('modalCounter').textContent = `${currentImageIndex + 1} / ${modalImages.length}`;
    }

    function nextImage() {
      if (!modalImages.length) return;
      currentImageIndex = (currentImageIndex + 1) % modalImages.length;
      updateModalImage();
    }

    function prevImage() {
      if (!modalImages.length) return;
      currentImageIndex = (currentImageIndex - 1 + modalImages.length) % modalImages.length;
      updateModalImage();
    }

    function closeImageModal() {
      const modal = document.getElementById('imageModal');
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = 'auto';
      // 선택 해제
      modalImages = [];
      currentImageIndex = 0;
    }

    // ===== 모바일 제스처(스와이프) 지원 추가 =====
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('imageModal');
      let startX = 0;
      let endX = 0;

      modal.addEventListener('touchstart', e => {
        startX = e.touches[0].clientX;
      });

      modal.addEventListener('touchmove', e => {
        endX = e.touches[0].clientX;
      });

      modal.addEventListener('touchend', () => {
        const diffX = startX - endX;
        if (Math.abs(diffX) > 50) {
          if (diffX > 0) nextImage();
          else prevImage();
        }
      });
    });


    // 모달 배경 클릭 시 닫기 (이미지나 버튼 클릭은 무시)
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('imageModal');
      modal.addEventListener('click', function(e) {
        // 모달 전체(배경)를 클릭했을 때만 닫기: 이미지나 버튼은 무시
        if (e.target === modal) {
          closeImageModal();
        }
      });

      // 키보드 제어
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeImageModal();
        if (e.key === 'ArrowRight') nextImage();
        if (e.key === 'ArrowLeft') prevImage();
      });
    });

    // 초기화
    document.addEventListener('DOMContentLoaded', function() {
      menuDataKo = parseMenu(menuTextKo);
      menuDataEn = parseMenu(menuTextEn);

      console.log('로드된 메뉴 수 (ko):', menuDataKo.length);
      console.log('로드된 메뉴 수 (en):', menuDataEn.length);
      console.log('첫 번째 메뉴:', menuDataKo[0]?.name);

      // 테마 초기화
      initTheme();

      // 강력 새로고침 버튼 이벤트
      document.getElementById('forceRefresh').addEventListener('click', forceRefresh);

      updateUI();

      // 검색 이벤트
      document.getElementById('searchInput').addEventListener('input', filterMenu);
    });
  </script>
</body>
</html>
